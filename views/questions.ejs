<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Questions & Answers</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
</head>
<body class="bg-dark text-white">
    <div class="container py-5">
        <h1>Ask a Question</h1>
        <% if (currentUser) { %>
            <form action="/questions" method="POST" class="mb-4">
                <input type="text" name="question" class="form-control mb-2" placeholder="Type your question..." required>
                <button type="submit" class="btn btn-primary">Add Question</button>
            </form>
        <% } else { %>
            <div class="alert alert-warning mb-4">
                Please <a href="/login" class="alert-link">log in</a> or <a href="/login" class="alert-link">sign up</a> to ask or answer questions.
            </div>
        <% } %>
        <h2>All Questions</h2>
        <ul class="list-group">
            <% questions.forEach((q) => { %>
                <li class="list-group-item bg-secondary text-white mb-3">
                    <strong><%= q.author ? q.author : "Anonymous" %>:</strong>
                    <strong>Q: <%= q.question %></strong>
                    <ul>
                        <% q.answers.forEach((a) => { %>
                            <li>
                                <strong><%= a.author ? a.author : "Anonymous" %>:</strong>
                                <span class="text-info">A: <%= a.answer %></span>
                                <form action="/questions/<%= q.id %>/answers/<%= a.id %>/upvote" method="POST" style="display:inline;">
                                    <button type="submit" class="btn btn-success btn-sm">â–² <%= a.votes %></button>
                                </form>
                            </li>
                        <% }) %>
                    </ul>
                    <% if (currentUser) { %>
                        <form action="/questions/<%= q.id %>/answer" method="POST" class="mt-2">
                            <div class="input-group">
                                <input type="text" name="answer" class="form-control" placeholder="Your answer..." required>
                                <button type="submit" class="btn btn-light">Answer</button>
                            </div>
                        </form>
                    <% } %>
                </li>
            <% }) %>
        </ul>
        <a href="/" class="btn btn-light mt-4">Back to Home</a>
    </div>
</body>
</html>